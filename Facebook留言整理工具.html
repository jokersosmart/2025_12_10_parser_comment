<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facebook ç•™è¨€æ•´ç†å·¥å…·</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", sans-serif;
            background: linear-gradient(135deg, #1877f2 0%, #0a66c2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            background: linear-gradient(135deg, #1877f2 0%, #0a66c2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 { font-size: 32px; margin-bottom: 10px; }
        
        .content { padding: 30px; }
        
        .step {
            background: #f8f9fa;
            border-left: 4px solid #1877f2;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 6px;
        }
        
        .step-title {
            font-size: 18px;
            font-weight: bold;
            color: #1877f2;
            margin-bottom: 15px;
        }
        
        .input-group {
            margin: 15px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            color: white;
            margin: 5px;
        }
        
        .btn-primary { background: #1877f2; }
        .btn-primary:hover { background: #166fe5; }
        .btn-success { background: #10b981; }
        .btn-info { background: #0ea5e9; }
        .btn-danger { background: #ef4444; }
        
        .alert {
            padding: 15px 20px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .alert-success { background: #d1fae5; color: #065f46; border-left: 4px solid #10b981; }
        .alert-error { background: #fee2e2; color: #991b1b; border-left: 4px solid #ef4444; }
        .alert-info { background: #dbeafe; color: #1e40af; border-left: 4px solid #3b82f6; }
        
        .hidden { display: none; }
        
        .progress {
            background: #e5e7eb;
            border-radius: 6px;
            height: 30px;
            margin: 15px 0;
        }
        
        .progress-bar {
            background: #1877f2;
            height: 100%;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 0.3s;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
        }
        
        .stat-value { font-size: 32px; font-weight: bold; color: #1877f2; }
        .stat-label { font-size: 14px; color: #6c757d; margin-top: 5px; }
        
        .comments-display {
            max-height: 600px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            margin-top: 20px;
        }
        
        .comment-item {
            padding: 15px;
            border-bottom: 1px solid #f1f3f5;
        }
        
        .comment-item:hover { background: #f8f9fa; }
        
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .commenter {
            font-weight: bold;
            color: #1877f2;
        }
        
        .comment-content {
            color: #212529;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin: 15px 0;
        }
        
        .help-text {
            font-size: 13px;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“˜ Facebook ç•™è¨€çˆ¬èŸ²å·¥å…·</h1>
            <p>è¼¸å…¥Token â†’ è²¼ä¸Šç¶²å€ â†’ è‡ªå‹•çˆ¬å–ç•™è¨€ â†’ ç·¨è¼¯æ•´ç† â†’ åŒ¯å‡ºExcel</p>
        </div>
        
        <div class="content">
            <!-- æ­¥é©Ÿ1: Token -->
            <div class="step">
                <div class="step-title">æ­¥é©Ÿ 1ï¸âƒ£: è¼¸å…¥æ‚¨çš„ Facebook Access Token</div>
                <div id="tokenAlert"></div>
                <div class="input-group">
                    <label>Facebook Access Token</label>
                    <input type="text" id="tokenInput" placeholder="è²¼ä¸Šæ‚¨çš„Facebook Token...">
                    <div class="help-text">
                        ğŸ’¡ å¦‚ä½•å–å¾—ï¼š<a href="https://developers.facebook.com/tools/explorer/" target="_blank">Graph API Explorer</a> 
                        â†’ Get Token â†’ Get User Access Token â†’ å‹¾é¸ pages_read_engagement
                    </div>
                </div>
                <button class="btn btn-primary" onclick="verifyToken()">ğŸ” é©—è­‰Token</button>
                <button class="btn btn-info" onclick="testWithSample()">âœ¨ ä½¿ç”¨ç¯„ä¾‹è³‡æ–™æ¸¬è©¦</button>
            </div>
            
            <!-- æ­¥é©Ÿ2: é¸æ“‡æ¨¡å¼ -->
            <div class="step hidden" id="step2">
                <div class="step-title">æ­¥é©Ÿ 2ï¸âƒ£: é¸æ“‡çˆ¬å–æ–¹å¼</div>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="mode" value="post" checked>
                        å–®ä¸€è²¼æ–‡æ¨¡å¼
                    </label>
                    <label>
                        <input type="radio" name="mode" value="page">
                        ç²‰å°ˆæ‰¹æ¬¡æ¨¡å¼
                    </label>
                </div>
                
                <div id="postMode">
                    <div class="input-group">
                        <label>Facebook è²¼æ–‡ç¶²å€</label>
                        <input type="text" id="postUrl" placeholder="ä¾‹å¦‚ï¼šhttps://www.facebook.com/share/p/17qJZ8zHpt/">
                        <div class="help-text">æ”¯æ´å„ç¨®Facebookè²¼æ–‡é€£çµæ ¼å¼</div>
                    </div>
                </div>
                
                <div id="pageMode" class="hidden">
                    <div class="input-group">
                        <label>Facebook ç²‰çµ²å°ˆé ç¶²å€æˆ–ID</label>
                        <input type="text" id="pageInput" placeholder="ä¾‹å¦‚ï¼šhttps://www.facebook.com/yourpage">
                    </div>
                    <div class="input-group">
                        <label>çˆ¬å–å¹¾ç¯‡æœ€æ–°è²¼æ–‡</label>
                        <select id="postLimit">
                            <option value="5">5ç¯‡è²¼æ–‡</option>
                            <option value="10" selected>10ç¯‡è²¼æ–‡</option>
                            <option value="20">20ç¯‡è²¼æ–‡</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="startScrape()">ğŸš€ é–‹å§‹çˆ¬å–</button>
            </div>
            
            <!-- æ­¥é©Ÿ3: é€²åº¦ -->
            <div class="step hidden" id="step3">
                <div class="step-title">æ­¥é©Ÿ 3ï¸âƒ£: çˆ¬å–é€²åº¦</div>
                <div id="progressInfo"></div>
                <div class="progress">
                    <div class="progress-bar" id="progressBar" style="width: 0%">0%</div>
                </div>
                <div id="progressDetails"></div>
            </div>
            
            <!-- æ­¥é©Ÿ4: çµæœ -->
            <div class="step hidden" id="step4">
                <div class="step-title">æ­¥é©Ÿ 4ï¸âƒ£: çˆ¬å–çµæœ</div>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalComments">0</div>
                        <div class="stat-label">ç¸½ç•™è¨€æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPosts">0</div>
                        <div class="stat-label">è™•ç†è²¼æ–‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="scrapeTime">0</div>
                        <div class="stat-label">è™•ç†æ™‚é–“ï¼ˆç§’ï¼‰</div>
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <button class="btn btn-success" onclick="exportExcel()">ğŸ“¥ åŒ¯å‡ºExcel</button>
                    <button class="btn btn-info" onclick="copyAll()">ğŸ“‹ è¤‡è£½æ‰€æœ‰ç•™è¨€</button>
                    <input type="text" id="searchBox" placeholder="ğŸ” æœå°‹ç•™è¨€..." 
                        style="width: 300px; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; margin-left: 10px;"
                        onkeyup="filterComments()">
                </div>
                
                <div class="comments-display" id="commentsDisplay"></div>
            </div>
        </div>
    </div>

    <script>
        let token = '';
        let allComments = [];
        let startTime = 0;
        
        // ç›£è½æ¨¡å¼åˆ‡æ›
        document.querySelectorAll('input[name="mode"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                document.getElementById('postMode').classList.toggle('hidden', e.target.value !== 'post');
                document.getElementById('pageMode').classList.toggle('hidden', e.target.value !== 'page');
            });
        });
        
        // é©—è­‰Token
        async function verifyToken() {
            const inputToken = document.getElementById('tokenInput').value.trim();
            const alertDiv = document.getElementById('tokenAlert');
            
            if (!inputToken) {
                alertDiv.innerHTML = '<div class="alert alert-error">âš ï¸ è«‹è¼¸å…¥Token</div>';
                return;
            }
            
            alertDiv.innerHTML = '<div class="alert alert-info">ğŸ” æ­£åœ¨é©—è­‰Token...</div>';
            
            try {
                const response = await fetch(`https://graph.facebook.com/v18.0/me?fields=id,name&access_token=${inputToken}`);
                const data = await response.json();
                
                if (data.error) {
                    alertDiv.innerHTML = `<div class="alert alert-error">âŒ Tokenç„¡æ•ˆï¼š${data.error.message}<br><small>éŒ¯èª¤ä»£ç¢¼ï¼š${data.error.code}</small></div>`;
                    return;
                }
                
                token = inputToken;
                localStorage.setItem('fb_token', token);
                
                alertDiv.innerHTML = `<div class="alert alert-success">âœ… Tokené©—è­‰æˆåŠŸï¼<br>å¸³è™Ÿï¼š${data.name} (ID: ${data.id})</div>`;
                document.getElementById('step2').classList.remove('hidden');
                
            } catch (error) {
                alertDiv.innerHTML = `<div class="alert alert-error">âŒ é©—è­‰å¤±æ•—ï¼š${error.message}</div>`;
            }
        }
        
        // ä½¿ç”¨ç¯„ä¾‹è³‡æ–™æ¸¬è©¦
        function testWithSample() {
            allComments = [
                {
                    id: 1, from: {name: 'ç‹å°æ˜', id: '123'}, message: 'å¾ˆå¯¦ç”¨çš„è³‡è¨Šï¼Œæ„Ÿè¬åˆ†äº«ï¼',
                    created_time: '2025-11-18T10:30:00+0000', like_count: 15, sourcePost: 'è²¼æ–‡1'
                },
                {
                    id: 2, from: {name: 'æå°è¯', id: '456'}, message: 'è«‹å•æœ‰æ›´è©³ç´°çš„æ•™å­¸å—ï¼Ÿ',
                    created_time: '2025-11-18T11:00:00+0000', like_count: 8, sourcePost: 'è²¼æ–‡1'
                },
                {
                    id: 3, from: {name: 'å¼µå¤§æ˜', id: '789'}, message: 'å·²åˆ†äº«çµ¦æœ‹å‹äº†ï¼',
                    created_time: '2025-11-18T12:15:00+0000', like_count: 12, sourcePost: 'è²¼æ–‡2'
                },
                {
                    id: 4, from: {name: 'Amy Chen', id: '321'}, message: 'Very helpful, thank you!',
                    created_time: '2025-11-18T13:20:00+0000', like_count: 20, sourcePost: 'è²¼æ–‡2'
                },
                {
                    id: 5, from: {name: 'é™³å°èŠ³', id: '654'}, message: 'æ”¶è—äº†ï¼Œä¹‹å¾Œæ…¢æ…¢çœ‹',
                    created_time: '2025-11-18T14:00:00+0000', like_count: 6, sourcePost: 'è²¼æ–‡3'
                },
                {
                    id: 6, from: {name: 'æ—å¿—æ˜', id: '987'}, message: 'å¯«å¾—å¾ˆæ¸…æ¥šï¼Œè®šğŸ‘',
                    created_time: '2025-11-18T15:30:00+0000', like_count: 10, sourcePost: 'è²¼æ–‡3'
                },
                {
                    id: 7, from: {name: 'é»ƒå°ç¾', id: '147'}, message: 'æ­£å¥½éœ€è¦é€™å€‹è³‡è¨Š',
                    created_time: '2025-11-19T09:00:00+0000', like_count: 5, sourcePost: 'è²¼æ–‡4'
                },
                {
                    id: 8, from: {name: 'John Lee', id: '258'}, message: 'Excellent content! ğŸŒŸ',
                    created_time: '2025-11-19T10:00:00+0000', like_count: 18, sourcePost: 'è²¼æ–‡4'
                },
                {
                    id: 9, from: {name: 'å³å¤§å‹‡', id: '369'}, message: 'å·²è¿½è¹¤å°ˆé äº†',
                    created_time: '2025-11-19T11:00:00+0000', like_count: 7, sourcePost: 'è²¼æ–‡5'
                },
                {
                    id: 10, from: {name: 'åŠ‰å°å©·', id: '741'}, message: 'æœŸå¾…ä¸‹ä¸€ç¯‡æ–‡ç« ',
                    created_time: '2025-11-19 12:00:00+0000', like_count: 11, sourcePost: 'è²¼æ–‡5'
                }
            ];
            
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.add('hidden');
            displayResults(allComments, [{id: '1', name: 'ç¯„ä¾‹è²¼æ–‡'}]);
            showAlert('âœ¨ å·²è¼‰å…¥10å‰‡ç¯„ä¾‹ç•™è¨€ï¼Œæ‚¨å¯ä»¥é«”é©—æ‰€æœ‰åŠŸèƒ½ï¼', 'info', 3000);
        }
        
        // é–‹å§‹çˆ¬å–
        async function startScrape() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            document.getElementById('step3').classList.remove('hidden');
            startTime = Date.now();
            
            if (mode === 'post') {
                await scrapePost();
            } else {
                await scrapePage();
            }
        }
        
        // çˆ¬å–å–®ä¸€è²¼æ–‡
        async function scrapePost() {
            const postUrl = document.getElementById('postUrl').value.trim();
            
            if (!postUrl) {
                alert('è«‹è¼¸å…¥è²¼æ–‡ç¶²å€');
                return;
            }
            
            const postId = parsePostId(postUrl);
            if (!postId) {
                showProgress(0, 'ç„¡æ³•è§£æè²¼æ–‡ç¶²å€', 'error');
                return;
            }
            
            showProgress(10, 'æ­£åœ¨å–å¾—è²¼æ–‡è³‡è¨Š...');
            
            try {
                const comments = await fetchComments(postId);
                displayResults(comments, [{id: postId, url: postUrl}]);
            } catch (error) {
                showProgress(0, 'âŒ éŒ¯èª¤ï¼š' + error.message, 'error');
            }
        }
        
        // çˆ¬å–ç²‰å°ˆ
        async function scrapePage() {
            const pageInput = document.getElementById('pageInput').value.trim();
            const limit = parseInt(document.getElementById('postLimit').value);
            
            if (!pageInput) {
                alert('è«‹è¼¸å…¥ç²‰å°ˆç¶²å€');
                return;
            }
            
            let pageId = pageInput;
            if (pageInput.includes('facebook.com')) {
                pageId = parsePageId(pageInput);
            }
            
            showProgress(5, 'æ­£åœ¨å–å¾—ç²‰å°ˆè³‡è¨Š...');
            
            try {
                // å–å¾—è²¼æ–‡åˆ—è¡¨
                showProgress(10, `æ­£åœ¨å–å¾—æœ€è¿‘${limit}ç¯‡è²¼æ–‡...`);
                const posts = await fetchPosts(pageId, limit);
                
                if (posts.length === 0) {
                    showProgress(0, 'âŒ æ‰¾ä¸åˆ°è²¼æ–‡æˆ–ç„¡æ¬Šé™å­˜å–', 'error');
                    return;
                }
                
                // å°æ¯å€‹è²¼æ–‡æŠ“ç•™è¨€
                allComments = [];
                for (let i = 0; i < posts.length; i++) {
                    const post = posts[i];
                    const progress = 10 + (i / posts.length) * 80;
                    showProgress(progress, `æ­£åœ¨è™•ç†ç¬¬ ${i+1}/${posts.length} ç¯‡è²¼æ–‡...`);
                    
                    const comments = await fetchComments(post.id);
                    comments.forEach(c => {
                        c.sourcePost = post.message?.substring(0, 30) || `è²¼æ–‡${i+1}`;
                        c.sourceUrl = `https://facebook.com/${post.id}`;
                        allComments.push(c);
                    });
                    
                    await sleep(300);
                }
                
                showProgress(100, 'å®Œæˆï¼');
                displayResults(allComments, posts);
                
            } catch (error) {
                showProgress(0, 'âŒ éŒ¯èª¤ï¼š' + error.message, 'error');
            }
        }
        
        // å–å¾—ç²‰å°ˆè²¼æ–‡
        async function fetchPosts(pageId, limit) {
            const url = `https://graph.facebook.com/v18.0/${pageId}/posts?fields=id,message,created_time&limit=${limit}&access_token=${token}`;
            const response = await fetch(url);
            const data = await response.json();
            
            if (data.error) throw new Error(data.error.message);
            return data.data || [];
        }
        
        // å–å¾—ç•™è¨€
        async function fetchComments(postId) {
            const comments = [];
            let url = `https://graph.facebook.com/v18.0/${postId}/comments?fields=id,from{name,id},message,created_time,like_count&limit=100&access_token=${token}`;
            
            while (url) {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.error) {
                    if (data.error.code === 100) break;
                    throw new Error(data.error.message);
                }
                
                if (data.data) comments.push(...data.data);
                url = data.paging?.next || null;
                
                if (url) await sleep(200);
            }
            
            return comments;
        }
        
        // è§£æè²¼æ–‡ID
        function parsePostId(url) {
            // å„ç¨®Facebookç¶²å€æ ¼å¼
            let match;
            
            // æ ¼å¼1: /posts/123456
            match = url.match(/\/posts\/(\d+)/);
            if (match) return match[1];
            
            // æ ¼å¼2: /p/ABC123
            match = url.match(/\/p\/([A-Za-z0-9]+)/);
            if (match) return match[1];
            
            // æ ¼å¼3: ç´”æ•¸å­—æˆ–ID
            match = url.match(/(\d{10,})/);
            if (match) return match[1];
            
            return url; // å˜—è©¦åŸæ¨£ä½¿ç”¨
        }
        
        // è§£æç²‰å°ˆID
        function parsePageId(url) {
            const match = url.match(/facebook\.com\/([^\/\?]+)/);
            return match ? match[1] : url;
        }
        
        // é¡¯ç¤ºçµæœ
        function displayResults(comments, posts) {
            const duration = ((Date.now() - startTime) / 1000).toFixed(1);
            
            document.getElementById('step4').classList.remove('hidden');
            document.getElementById('totalComments').textContent = comments.length;
            document.getElementById('totalPosts').textContent = posts.length;
            document.getElementById('scrapeTime').textContent = duration;
            
            allComments = comments;
            renderComments();
        }
        
        // æ¸²æŸ“ç•™è¨€
        function renderComments(filtered = null) {
            const display = document.getElementById('commentsDisplay');
            const data = filtered || allComments;
            
            if (data.length === 0) {
                display.innerHTML = '<p style="text-align:center;padding:40px;color:#6c757d;">æ²’æœ‰ç•™è¨€è³‡æ–™</p>';
                return;
            }
            
            display.innerHTML = data.map(c => `
                <div class="comment-item">
                    <div class="comment-header">
                        <span class="commenter">${c.from?.name || 'æœªçŸ¥ä½¿ç”¨è€…'}</span>
                        <span style="font-size:12px;color:#6c757d;">${formatTime(c.created_time)}</span>
                    </div>
                    <div class="comment-content">${c.message || ''}</div>
                    <div style="font-size:12px;color:#6c757d;margin-top:8px;">
                        ğŸ‘ ${c.like_count || 0} | ä¾†æºï¼š${c.sourcePost || 'æœªçŸ¥'}
                    </div>
                </div>
            `).join('');
        }
        
        // ç¯©é¸
        function filterComments() {
            const keyword = document.getElementById('searchBox')?.value.toLowerCase();
            if (!keyword) {
                renderComments();
                return;
            }
            
            const filtered = allComments.filter(c => 
                (c.message && c.message.toLowerCase().includes(keyword)) ||
                (c.from?.name && c.from.name.toLowerCase().includes(keyword))
            );
            renderComments(filtered);
        }
        
        // åŒ¯å‡ºExcel
        function exportExcel() {
            if (allComments.length === 0) {
                alert('æ²’æœ‰è³‡æ–™å¯åŒ¯å‡º');
                return;
            }
            
            const exportData = allComments.map(c => ({
                'ç•™è¨€è€…': c.from?.name || 'æœªçŸ¥',
                'ç•™è¨€å…§å®¹': c.message || '',
                'æ™‚é–“': formatTime(c.created_time),
                'æŒ‰è®šæ•¸': c.like_count || 0,
                'ä¾†æº': c.sourcePost || ''
            }));
            
            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ç•™è¨€è³‡æ–™');
            
            ws['!cols'] = [{wch:20},{wch:50},{wch:20},{wch:10},{wch:30}];
            
            const timestamp = new Date().toISOString().slice(0,16).replace('T','_').replace(/:/g,'');
            XLSX.writeFile(wb, `Facebookç•™è¨€_${timestamp}.xlsx`);
            
            showAlert('ğŸ“¥ Excelå·²ä¸‹è¼‰', 'success');
        }
        
        // è¤‡è£½
        function copyAll() {
            if (allComments.length === 0) {
                alert('æ²’æœ‰è³‡æ–™');
                return;
            }
            
            const text = allComments.map(c => 
                `${c.from?.name}\t${c.message}\t${formatTime(c.created_time)}\t${c.like_count}`
            ).join('\n');
            
            navigator.clipboard.writeText('ç•™è¨€è€…\tç•™è¨€å…§å®¹\tæ™‚é–“\tæŒ‰è®šæ•¸\n' + text);
            showAlert(`âœ… å·²è¤‡è£½ ${allComments.length} å‰‡ç•™è¨€`, 'success');
        }
        
        // å·¥å…·å‡½æ•¸
        function formatTime(time) {
            if (!time) return '';
            return new Date(time).toLocaleString('zh-TW');
        }
        
        function showProgress(percent, text, type = 'info') {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressBar').textContent = Math.round(percent) + '%';
            const className = type === 'error' ? 'alert-error' : 'alert-info';
            document.getElementById('progressDetails').innerHTML = `<div class="alert ${className}">${text}</div>`;
        }
        
        function showAlert(msg, type, duration = 2000) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = msg;
            alert.style.position = 'fixed';
            alert.style.top = '20px';
            alert.style.right = '20px';
            alert.style.zIndex = '9999';
            document.body.appendChild(alert);
            setTimeout(() => alert.remove(), duration);
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // è¼‰å…¥å„²å­˜çš„Token
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('fb_token');
            if (saved) {
                document.getElementById('tokenInput').value = saved;
                showAlert('ğŸ’¡ å·²è¼‰å…¥ä¸Šæ¬¡ä½¿ç”¨çš„Token', 'info');
            }
        });
    </script>
</body>
</html>
